{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <!-- Favicon icon -->
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="{% static 'images/favicon.png' %}"
    />
    <title>Digital Dashboard</title>
    <!-- Custom CSS -->
    <link href="{% static 'css/float-chart.css' %}" rel="stylesheet" />
    <!-- Custom CSS -->
    <link href="{% static 'css/style.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/custom.css' %}" rel="stylesheet" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js' %}"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js' %}/1.4.2/respond.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
   
    
  </head>

  <body>
    
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css' %} -->
    <!-- ============================================================== -->
<!--    <div class="preloader">-->
<!--      <div class="lds-ripple">-->
<!--        <div class="lds-pos"></div>-->
<!--        <div class="lds-pos"></div>-->
<!--      </div>-->
<!--    </div>-->
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    
    <div id="main-wrapper">
      <!-- ============================================================== -->
      <!-- Topbar header - style you can find in pages.scss -->
      <!-- ============================================================== -->
      
      <!-- ============================================================== -->
      <!-- End Topbar header -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- Left Sidebar - style you can find in sidebar.scss  -->
      <!-- ============================================================== -->
      <aside class="left-sidebar" data-sidebarbg="skin5">
        <!-- Sidebar scroll-->
        <div class="scroll-sidebar">
          <!-- Sidebar navigation-->
          <nav class="sidebar-nav">
            <ul id="sidebarnav" class="p-t-30">
              <li class="sidebar-item">
                <h4 class="sidebar-link waves-effect waves-dark"> <i class="material-icons">dashboard</i
                  > Data Dash</h4>
              </li>


              {% if user.is_authenticated %}
              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  aria-expanded="false"
                  ><span class="hide-menu"> Welcome {{ user.username }} ({{user.userprofile.user_type}}) </span></a>
              </li>

              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/home"
                  aria-expanded="false"
                  ><i class="material-icons">dashboard</i
                  ><span class="hide-menu">Dashboard </span></a
                >
              </li>
              <!-- <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/accounts/logout"
                  aria-expanded="false"
                  ><i class="material-icons">login</i><span class="hide-menu">Logout </span></a
                >
              </li> -->


              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="javascript:void(0)"
                  aria-expanded="false"
                  ><i class="material-icons">settings</i
                  ><span class="hide-menu">User Settings </span></a    
             
              </li>

              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/accounts/password_change"
                  aria-expanded="false"
                  ><i class="material-icons">login</i><span class="hide-menu">Change Password </span></a
                >
              </li>

              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/speedtest/"
                  aria-expanded="false"
                  ><i class="material-icons">login</i><span class="hide-menu">Speed Test </span></a
                >
              </li>

              {% else %}
              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/accounts/login"
                  aria-expanded="false"
                  ><i class="material-icons">login</i><span class="hide-menu">Login </span></a
                >
              </li>
              {% endif %}


              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/wifihotspots"
                  aria-expanded="false"
                  ><i class="material-icons">logout</i><span class="hide-menu">Wifi Hotspots </span></a
                >
              </li>

              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/statcollector"
                  aria-expanded="false"
                  ><i class="material-icons">logout</i><span class="hide-menu">Canadian Statistics </span></a
                >
              </li>
              

              <li class="sidebar-item">
                <a
                  class="sidebar-link waves-effect waves-dark"
                  href="/dashboard/accounts/logout"
                  aria-expanded="false"
                  ><i class="material-icons">logout</i><span class="hide-menu">Logout </span></a
                >
              </li>


             
              
            </ul>
          </nav>
          <!-- End Sidebar navigation -->
        </div>
        <!-- End Sidebar scroll-->
      </aside>
      <!-- ============================================================== -->
      <!-- End Left Sidebar - style you can find in sidebar.scss  -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- Page wrapper  -->
      <!-- ============================================================== -->
      <div class="page-wrapper">
        <!-- ============================================================== -->
        <!-- Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <!-- <div class="page-breadcrumb">
          <div class="row">
            <div class="col-12 d-flex no-block align-items-center">
              <h4 class="page-title">Dashboard</h4>
              <div class="ml-auto text-right">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                   
                  </ol>
                </nav>
              </div>
            </div>
          </div>
        </div> -->
        <!-- ============================================================== -->
        <!-- End Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Container fluid  -->
        <!-- ============================================================== -->
        <!-- <div class="container-fluid"> -->
          <!-- ============================================================== -->
          <!-- Sales Cards  -->
          <!-- ============================================================== -->
          <!-- <div class="row">
            <!-- Column -->
            <!-- <div class="col-md-6 col-lg-2 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-cyan text-center">
                  <h1 class="font-light text-white">
                    <i class="mdi mdi-view-dashboard"></i>
                  </h1>
                  <h6 class="text-white">Dashboard</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
            <!-- <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-success text-center">
                  <h1 class="font-light text-white">
                    <i class="mdi mdi-chart-areaspline"></i>
                  </h1>
                  <h6 class="text-white">Graphs</h6>
                </div>
              </div> -->
            <!-- Column -->

            <!-- Column -->
          




                  <!-- <form class="form-inline justify-content-center" method="POST">
                    <div class="form-group mb-2">
                      {% csrf_token %}
                        {{form.as_p}}  
                    
              
                                                       
                    </div>  
                    <button class="btn btn-primary btn-sm" style="width: 150px; height: 38px;" type="submit">Submit Query</button>
                                       
                  </form> -->
               
           <br>

           <!-- Note the state/province probably needs to be updated based on the Country selected -->
          <div class="content ">
             <div class="container-fluid">
              <h4><strong>Digital Dashboard</strong></h4><br>
                <form method="POST">
                  {% csrf_token %}
                    <!-- <div class="row"> -->
        
                        <!-- <div class="col"> -->

                          <div class="form-inline">
                            <div class="form-group" style="margin-right: 15px;">
                              <input type="hidden">Country</input>
                              <select name="country" id="different_countries" onchange=form.submit()>
                                <option disabled selected="true"> -- select an option -- </option>
                                {% if inputcountry == 'usa' %}
                                <option selected="true" value="usa">USA</option>
                                <option value="canada">Canada</option>
                                {% elif inputcountry == 'canada' %}
                                <option selected="true" value="canada">Canada</option>
                                <option value="usa">USA</option>
                                {% else %}
                                <option value="canada">Canada</option>
                                <option value="usa">USA</option>
                                {% endif %}
                                    <!-- <option value="usa">USA</option>
                                    <option value="canada">Canada</option>
                                  -->
                              </select>
                            </div>
                            
                        <!-- </div>  -->
                        <!-- <div class="col"> -->
                          <div class="form-group" style="margin-right: 15px;">
                            <input type="hidden">State/Province</input>
                            <select name="locations" id="different_locations">
                              <option disabled selected="true"> -- select an option -- </option>
                              {% for item in location_list  %}
                                 {% if inputlocation == item %}
                                 <option selected="true" value="{{item}}">{{ item }}</option>
                                 {% else %}
                                  <option value="{{item}}">{{ item }}</option>
                                 {% endif %}
                              {% endfor %}
                            </select>
                          </div>
                        <!-- </div> -->
                        <!-- <div class="col"> -->
                          <button type="submit" class="btn btn-primary btn w-40">Filter</button>
                        <!-- </div>  -->

                      
                      
                          

                    </div>
                    <!-- <button type="submit" class="btn btn-primary btn mt-4 w-50">Filter</button> -->
                  </form> 

                 
                <br><br>
                <div class="row">

                  <div class="col-sm-3">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Statistic 1 </h4>
                     </div>
                      <div class="card-body">
                        <h5 class="card-title">Total number of School Districts</h5>
                        <!-- <div id="my_dataviz"></div> -->
                        <h1>{{firststat}}</h1>
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Statistic 2 </h4>
                     </div>
                      <div class="card-body">
                        <h5 class="card-title">Number Of states</h5>
                        <h1>{{secondstat}}</h1>
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Statistic 3 </h4>
                     </div>
                      <div class="card-body">
                        <!-- <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a> -->
                        <div class="row">
                          <h5 class="card-title mr-2">Number Of Learning Products</h5>
                          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                              Products
                          </button>
                          
                          
                        </div>
                        <h1>{{thirdstat}}</h1>
                        
                        
                        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                          <div class="modal-dialog">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="staticBackdropLabel">List of Products</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              {% for product in products %}
                              <div class="modal-body">
                                <a href="{{product.url}}">{{product.product_name}}</a>
                              </div>
                              {% endfor %}
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                              </div>
                            </div>
                          </div>
                        </div>
                         <!-- <button class="btn btn-primary">List of Learning Products</button> -->
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Statistic 4 </h4>
                     </div>
                      <div class="card-body">
                        <!-- <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a> -->
                        <!-- <h5 class="card-title">Count of Suburbs, Rural, Town and City</h5> -->
                        <!-- <h1>{{suburb}}</h1> <h1>{{rural}}</h1> <h1>{{town}}</h1> <h1>{{city}}</h1> -->
                        <h5 class="card-title">Number Of states</h5>
                        <h1>{{secondstat}}</h1>
                      </div>
                    </div>
                  </div>


                  <div class="col-sm-12 col-md-12 col-lg-6">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Average Expenditure per pupil for different states </h4>
                     </div>
                      <div class="card-body align-items-center mx-auto mt-auto mb-auto">
                        <!-- <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a> -->
                        <div id="my_dataviz"></div>
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-12 col-md-12 col-lg-6">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Percentage of Locale in All States </h4>
                     </div>
                      <div class="card-body align-items-center mx-auto mt-auto mb-auto" >
                        <!-- <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a> -->
                        <div id="my_datadonutviz"></div>
                        
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-6">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Graph of Percentage Access of Black/Hispanic in different States </h4>
                     </div>
                      <div class="card-body">
                        <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a>
                        <!-- <div id="my_dataviz"></div> -->
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-6">
                    <div class="card">
                      <div class="card-header ">
                        <h4 class="card-title">Graph of Percentage Access of Black/Hispanic in different States </h4>
                     </div>
                      <div class="card-body">
                        <h5 class="card-title">Special title treatment</h5>
                        <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                        <a href="#" class="btn btn-primary">Go somewhere</a>
                      </div>
                    </div>
                  </div>
                </div>


          <br>

          <!-- <div class="content ">
            <div class="container-fluid">
                <div class="row d-flex justify-content-center">
                    <div class="col-md-8"> 
                        <div class="card text-center">
                            <div class="card-header ">
                                <h4 class="card-title">Graph of Percentage Access of Black/Hispanic in different States </h4>
                            </div>
                            <div class="card-body">
                              <div class="myChart">
                                <canvas id="Chart1"></canvas>
                              </div>
                            </div>
                         </div>
                     </div>

                    <div class="col-md-8">
                      <div class="card">
                          <div class="card-header ">
                              <h4 class="card-title">Expenditure per pupil in Different States</h4>
                              <p> Note the value of 0 indicates that no Kaggle data was found for these specific states.</p>
                          </div>
                          <div class="card-body align-items-center mx-auto mt-auto mb-auto">
                            <div class="myChart">
                              <div id="my_dataviz"></div>
                            </div>
                          </div>
                          
                      </div>
                   </div>

                   
                 </div>
                      
                  {% if district %}
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header ">
                                <h4 class="card-title">Graph of District Id's and County connections in <span id="userinput"></span></h4>
                            </div>
                            <div class="card-body" >
                              <div class="myChart">
                                <canvas id="Chart2"></canvas>
                              </div>
                            </div>
                            
                        </div>
                    </div>
                  {% endif %}


                </div>              
             </div>
           </div> -->

    
        
         

        <script>

          // const ctx3 = document.getElementById('Chart3').getContext('2d');
          // var x = JSON.parse('{{ st | safe }}')
          // var y = JSON.parse('{{ ex | safe }}')
          // const Chart3 = new Chart(ctx3, {
          //     type: 'bar',
          //     data: {
          //         labels: x,
          //         datasets: [{
          //             label: 'Expenditure in dollars',
          //             data: y,
          //             backgroundColor: [
          //                 'rgba(255, 99, 132, 0.2)',
          //                 'rgba(54, 162, 235, 0.2)',
          //                 'rgba(255, 206, 86, 0.2)',
          //                 'rgba(75, 192, 192, 0.2)',
          //                 'rgba(153, 102, 255, 0.2)',
          //                 'rgba(255, 159, 64, 0.2)'
          //             ],
          //             borderColor: [
          //                 'rgba(255, 99, 132, 1)',
          //                 'rgba(54, 162, 235, 1)',
          //                 'rgba(255, 206, 86, 1)',
          //                 'rgba(75, 192, 192, 1)',
          //                 'rgba(153, 102, 255, 1)',
          //                 'rgba(255, 159, 64, 1)'
          //             ],
          //             borderWidth: 1
          //         }]
          //     },
          //     options: {
                  
          //     }
          // });
         
          // const ctx1 = document.getElementById('Chart1').getContext('2d');
          // var label = JSON.parse('{{ state | safe }}')
          // var p = JSON.parse('{{ perc | safe }}')
          // const Chart1 = new Chart(ctx1, {
          //     type: 'bar',
          //     data: {
          //         labels: label,
          //         datasets: [{
          //             label: 'Percentage Access',
          //             data: p,
          //             backgroundColor: [
          //                 'rgba(255, 99, 132, 0.2)',
          //                 'rgba(54, 162, 235, 0.2)',
          //                 'rgba(255, 206, 86, 0.2)',
          //                 'rgba(75, 192, 192, 0.2)',
          //                 'rgba(153, 102, 255, 0.2)',
          //                 'rgba(255, 159, 64, 0.2)'
                    
          //             ],
          //             borderColor: [
          //                 'rgba(255, 99, 132, 1)',
          //                 'rgba(54, 162, 235, 1)',
          //                 'rgba(255, 206, 86, 1)',
          //                 'rgba(75, 192, 192, 1)',
          //                 'rgba(153, 102, 255, 1)',
          //                 'rgba(255, 159, 64, 1)'
                          
          //             ],
          //             borderWidth: 1
          //         }]
          //     },
          //     options: {
          //         scales: {
          //           y: {
          //                 beginAtZero: true
          //             }
                      
          //         }

          //     }
          // });

          // const ctx = document.getElementById('Chart2').getContext('2d');
          // document.getElementById("userinput").innerHTML = document.getElementById('id_state').value
          // var d = JSON.parse('{{ district | safe }}')
          // var c = JSON.parse('{{ county | safe }}')
          // const Chart2 = new Chart(ctx, {
          //     type: 'bar',
          //     data: {
          //         labels: d,
          //         datasets: [{
          //             label: 'County Connections Percentage',
          //             data: c,
          //             backgroundColor: [
          //                 'rgba(255, 99, 132, 0.2)',
          //                 'rgba(54, 162, 235, 0.2)',
          //                 'rgba(255, 206, 86, 0.2)',
          //                 'rgba(75, 192, 192, 0.2)',
          //                 'rgba(153, 102, 255, 0.2)',
          //                 'rgba(255, 159, 64, 0.2)'
          //             ],
          //             borderColor: [
          //                 'rgba(255, 99, 132, 1)',
          //                 'rgba(54, 162, 235, 1)',
          //                 'rgba(255, 206, 86, 1)',
          //                 'rgba(75, 192, 192, 1)',
          //                 'rgba(153, 102, 255, 1)',
          //                 'rgba(255, 159, 64, 1)'
          //             ],
          //             borderWidth: 1
          //         }]
          //     },
          //     options: {
          //         scales: {
          //             y: {
          //                 beginAtZero: true
          //             }
          //         }
          //     }
          // });



          var data = JSON.parse('{{ mydata | safe }}');
          var margin = {top: 30, right: 30, bottom: 70, left: 60},
          width = 560 - margin.left - margin.right,
          height = 300 - margin.top - margin.bottom;

          // append the svg object to the body of the page
          var svg = d3.select("#my_dataviz")
            .append("svg")
              .attr("preserveAspectRatio", "xMinYMin meet")
              .attr("viewBox", "0 0 600 300")
            .append("g")
              .attr("transform",
                    "translate(" + margin.left + "," + margin.top + ")");

          // Parse the Data
        
          // X axis
          var x = d3.scaleBand()
            .range([ 0, width ])
            .domain(data.map(function(d) { return d.state; }))
            .padding(0.2);
          svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x))
            .selectAll("text")
              .attr("transform", "translate(-10,0)rotate(-45)")
              .style("text-anchor", "end");

          // Add Y axis
          var y = d3.scaleLinear()
            .domain([0, 22000])
            .range([ height, 0]);
          svg.append("g")
            .call(d3.axisLeft(y));

          // Bars
          svg.selectAll("mybar")
            .data(data)
            .enter()
            .append("rect")
              .attr("x", function(d) { return x(d.state); })
              .attr("y", function(d) { return y(d.expenditure); })
              .attr("width", x.bandwidth())
              .attr("height", function(d) { return height - y(d.expenditure); })
              .attr("fill", "royalblue")


          //Donut graph
          var widthofdonut = 700;
          var heightofdonut = 410;
          var marginfordonut = 5;
          let s = JSON.parse('{{ suburb | safe }}');
          let r = JSON.parse('{{ rural | safe }}');
          let t = JSON.parse('{{ town | safe }}');
          let c = JSON.parse('{{ city | safe }}');
          console.log("value of suburb is", s)
          console.log("value of rural is", r)
          console.log("value of town is", t)
          console.log("value of city is", c)
          var radius = Math.min(widthofdonut, heightofdonut) / 2 - marginfordonut
        

            var svg1 = d3.select("#my_datadonutviz")
              .append("svg")
                .attr("width", widthofdonut)
                .attr("height", heightofdonut)
              .append("g")
                .attr("transform", "translate(" + widthofdonut / 2 + "," + heightofdonut / 2 + ")");

            // Create dummy data
            // var data = {a: 9, b: 20, c:30, d:8, e:12, f:3, g:7, h:14}
            let datafordonut = {suburb: s, rural: r, town:t, city:c}

            // set the color scale
            var colordonut = d3.scaleOrdinal()
              .domain(["suburb", "rural", "town", "city"])
              .range(d3.schemeDark2);

            // Compute the position of each group on the pie:
            var pie = d3.pie()
              .sort(null) // Do not sort group by size
              .value(function(d) {return d.value; })
            var data_ready = pie(d3.entries(datafordonut))

            // The arc generator
            var arc = d3.arc()
              .innerRadius(radius * 0.5)         // This is the size of the donut hole
              .outerRadius(radius * 0.8)
              

            // Another arc that won't be drawn. Just for labels positioning
            var outerArc = d3.arc()
              .innerRadius(radius * 0.9)
              .outerRadius(radius * 0.9)

            // Build the pie chart: Basically, each part of the pie is a path that we build using the arc function.
            svg1
              .selectAll('allSlices')
              .data(data_ready)
              .enter()
              .append('path')
              .attr('d', arc)
              .attr('fill', function(d){ return(colordonut(d.data.key)) })
              .attr("stroke", "white")
              .style("stroke-width", "2px")
              .style("opacity", 0.7)

            // Add the polylines between chart and labels:
            svg1
              .selectAll('allPolylines')
              .data(data_ready)
              .enter()
              .append('polyline')
                .attr("stroke", "black")
                .style("fill", "none")
                .attr("stroke-width", 1)
                .attr('points', function(d) {
                  var posA = arc.centroid(d) // line insertion in the slice
                  var posB = outerArc.centroid(d) // line break: we use the other arc generator that has been built only for that
                  var posC = outerArc.centroid(d); // Label position = almost the same as posB
                  var midangle = d.startAngle + (d.endAngle - d.startAngle) / 2 // we need the angle to see if the X position will be at the extreme right or extreme left
                  posC[0] = radius * 0.95 * (midangle < Math.PI ? 1 : -1); // multiply by 1 or -1 to put it on the right or on the left
                  return [posA, posB, posC]
                })

            // Add the polylines between chart and labels:
            svg1
              .selectAll('allLabels')
              .data(data_ready)
              .enter()
              .append('text')
                .text( function(d) { console.log(d.data.key) ; return d.data.key + ":" + d.data.value } )
                .attr('transform', function(d) {
                    var pos = outerArc.centroid(d);
                    var midangle = d.startAngle + (d.endAngle - d.startAngle) / 2
                    pos[0] = radius * 0.99 * (midangle < Math.PI ? 1 : -1);
                    return 'translate(' + pos + ')';
                
                })
                .style('text-anchor', function(d) {
                    var midangle = d.startAngle + (d.endAngle - d.startAngle) / 2
                    return (midangle < Math.PI ? 'start' : 'end')
                })

          </script>
                         
          
                              
                  






          <!-- ============================================================== -->
          <!-- Sales chart -->
          <!-- ============================================================== -->

          <!-- ============================================================== -->
          <!-- Sales chart -->
          <!-- ============================================================== -->
          <!-- ============================================================== -->
          <!-- Recent comment and chats -->
          <!-- ============================================================== -->

              <!-- Card -->
              <!-- card -->

              <!-- card new -->

            </div>
            <!-- column -->

            
          </div>
          <!-- ============================================================== -->
          <!-- Recent comment and chats -->
          <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Container fluid  -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->

        <!-- ============================================================== -->
        <!-- End footer -->
        <!-- ============================================================== -->
      </div>
      <!-- ============================================================== -->
      <!-- End Page wrapper  -->
      <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Wrapper -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- All Jquery -->
    <!-- ============================================================== -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/perfect-scrollbar.jquery.min.js' %}"></script>
    <script src="{% static 'js/sparkline.js' %}"></script>
    <!--Wave Effects -->
    <script src="{% static 'js/waves.js' %}"></script>
    <!--Menu sidebar -->
    <script src="{% static 'js/sidebarmenu.js' %}"></script>
    <!--Custom JavaScript -->
    <script src="{% static 'js/custom.min.js' %}"></script>
    <!--This page JavaScript -->
    <!-- <script src="dist/js/pages/dashboards/dashboard1.js' %}"></script> -->
    <!-- Charts js Files -->
    <script src="{% static 'js/excanvas.js' %}"></script>
    <script src="{% static 'js/jquery.flot.js' %}"></script>
    <script src="{% static 'js/jquery.flot.pie.js' %}"></script>
    <script src="{% static 'js/jquery.flot.time.js' %}"></script>
    <script src="{% static 'js/jquery.flot.stack.js' %}"></script>
    <script src="{% static 'js/jquery.flot.crosshair.js' %}"></script>
    <script src="{% static 'js/jquery.flot.tooltip.min.js' %}"></script>
    <script src="{% static 'js/chart-page-init.js' %}"></script>
  </body>
</html>
